# PaperTok unified .env (single source of truth)
#
# Copy to: papertok/.env
#   cp .env.example .env
#
# Notes:
# - Do NOT commit .env (gitignored).
# - Backend reads ONLY papertok/.env (single source of truth).
# - ops/*.sh will also source papertok/.env.

# ---- Server ----
PAPERTOK_HOST=0.0.0.0
PAPERTOK_PORT=8000

# ---- HuggingFace Daily Papers ----
HF_DAILY_PAPERS_URL=https://huggingface.co/api/daily_papers
HF_TOP_N=10

# ---- LLM (OpenAI-compatible) ----
OPENAI_BASE_URL=http://localhost:3003/v1
OPENAI_API_KEY=__PUT_KEY_HERE__
LLM_MODEL_TEXT=glm-x-preview
# SKIP_LLM=1

# ---- Storage ----
DB_URL=sqlite:////Users/gwaanl/.openclaw/workspace/papertok/data/db/papertok.sqlite

# ---- Pipeline options ----
DOWNLOAD_PDF=1
PAPERS_PDF_DIR=/Users/gwaanl/.openclaw/workspace/papertok/data/raw/pdfs

# ---- mineru (PDF -> markdown + images) ----
# Install heavy deps: pip install -r backend/requirements.mineru.txt
RUN_MINERU=1
MINERU_OUT_ROOT=/Users/gwaanl/.openclaw/workspace/papertok/data/mineru
MINERU_MODEL_SOURCE=modelscope
MINERU_MAX=10
# If MinerU fails (e.g. PDFium data format error), try to repair PDF into a cache copy and retry.
MINERU_REPAIR_ON_FAIL=1
# auto|qpdf|mutool|gs
MINERU_REPAIR_TOOL=auto
MINERU_REPAIR_CACHE_DIR=/Users/gwaanl/.openclaw/workspace/papertok/data/raw/pdfs_repaired

# ---- Languages ----
# Which language variants to generate/store (affects explain/caption/images and one-liners via jobs).
# Example: PAPERTOK_LANGS=zh,en
PAPERTOK_LANGS=zh

# ---- LLM content analysis based on MinerU markdown ----
RUN_CONTENT_ANALYSIS=1
CONTENT_ANALYSIS_MAX=10
CONTENT_ANALYSIS_INPUT_CHARS=80000
LLM_MODEL_ANALYSIS=glm-x-preview

# ---- One-liner quality ----
ONE_LINER_PREFER_MINERU=1
ONE_LINER_MINERU_INPUT_CHARS=20000
# REWRITE_ONE_LINER_FROM_MINERU=1
# REWRITE_ONE_LINER_MAX=10
# REWRITE_ONE_LINER_SKIP_RECENT_MINUTES=30

# ---- Image captioning (MinerU extracted images -> VLM captions cached to DB) ----
RUN_IMAGE_CAPTION=1
IMAGE_CAPTION_MODEL=glm-4.6v
IMAGE_CAPTION_MAX=100000
IMAGE_CAPTION_PER_PAPER=100000
IMAGE_CAPTION_CONTEXT_CHARS=2000
# merge|last
IMAGE_CAPTION_CONTEXT_STRATEGY=merge
IMAGE_CAPTION_CONTEXT_OCCURRENCES=3
# Caption concurrency (threads inside job)
IMAGE_CAPTION_CONCURRENCY=4

# ---- Paper generated images (Seedream / GLM-Image): magazine collage style ----
RUN_PAPER_IMAGES=1
PAPER_IMAGES_PER_PAPER=3
PAPER_IMAGES_MAX_PAPERS=10
PAPER_IMAGES_PLAN_EXPLAIN_CHARS=20000
# generate both providers by default
PAPER_IMAGES_PROVIDERS=seedream,glm
# which provider FEED cards should use: seedream|glm|auto
PAPER_IMAGES_DISPLAY_PROVIDER=seedream

# Seedream
SEEDREAM_ENDPOINT=https://ark.cn-beijing.volces.com/api/v3/images/generations
SEEDREAM_MODEL=doubao-seedream-4-5-251128
# SEEDREAM_API_KEY=__PUT_KEY_HERE__
# or
# SEEDREAM_API_KEYS=["k1","k2"]
# Must be at least 3686400 pixels
PAPER_GEN_IMAGE_SIZE=1440x2560
PAPER_GEN_IMAGES_DIR=/Users/gwaanl/.openclaw/workspace/papertok/data/gen_images

# GLM-Image
PAPER_GLM_IMAGE_SIZE=1088x1920
PAPER_GEN_IMAGES_GLM_DIR=/Users/gwaanl/.openclaw/workspace/papertok/data/gen_images_glm
# GLM_API_KEY=__PUT_KEY_HERE__
# or
# GLM_API_KEYS=["k1","k2"]

# ---- Frontend dist (served by backend) ----
FRONTEND_DIST_DIR=/Users/gwaanl/.openclaw/workspace/papertok/frontend/wikitok/frontend/dist

# ---- CORS ----
# For local MVP, wildcard is OK (we do not use cookies / allow_credentials=false)
CORS_ALLOW_ORIGINS=*

# ---- Security boundary (recommended even for LAN) ----
# Allowlist client IPs/subnets (comma-separated CIDRs). Default: private LAN + localhost.
# Set to "*" to disable allowlist.
# PAPERTOK_ALLOWED_CIDRS=127.0.0.1/32,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16
# If you run behind a reverse proxy and want to use X-Forwarded-For:
# PAPERTOK_TRUST_X_FORWARDED_FOR=1

# Optional Basic Auth (off by default)
# PAPERTOK_BASIC_AUTH=1
# PAPERTOK_BASIC_USER=papertok
# PAPERTOK_BASIC_PASS=change-me

# Optional Admin token: if set, /api/admin/* requires header X-Admin-Token
# PAPERTOK_ADMIN_TOKEN=change-me

# Logs directory (admin tools read/clear job_worker logs here)
PAPERTOK_LOG_DIR=/Users/gwaanl/.openclaw/workspace/papertok/data/logs

# Log rotation (launchd: com.papertok.logrotate)
# Rotate when a single *.log file exceeds this size (bytes)
# PAPERTOK_LOGROTATE_MAX_BYTES=20000000
# Keep at most N compressed archives per base log name
# PAPERTOK_LOGROTATE_KEEP=10
